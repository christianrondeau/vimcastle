Execute (initialize stats):
  let maxturns = 500
  let maxplaythroughs = 50
  let totalturns = 0
  let playthroughsturns = []

Execute (play story):
  let playhtroughs = 0
  while(playhtroughs < maxplaythroughs)
    let state = vimcastle#state#create()
    let state.scene = vimcastle#scene#load('main', 'index')
    call state.enter('explore')
    call state.scene.enter.invoke(state)
    let playhtroughs += 1
    let turns = 0
    while turns < maxturns && state.screen != 'gameover'
      let turns += 1
      if(len(state.actions().display))
        let actions = state.actions()
      else
        let actions = state.nav
      endif
      " 7/10 times, choose the 1st option
      if(vimcastle#utils#rnd(10) < 7)
        let key = actions.display[0].key
      else
        let key = vimcastle#utils#oneof(actions.display).key
      endif
      call actions.invokeByKey(key, state)
    endwhile
    let totalturns += turns
  call add(playthroughsturns, turns)
  endwhile
  let avgturns = totalturns / maxplaythroughs
  Log 'average turns/game: ' . avgturns . ' in ' . maxplaythroughs . ' playthroughs: ' . string(playthroughsturns)

Then (the game completed):
  if(!$CI)
    Assert avgturns > 20 && avgturns < 200, 'Too few/many turns'
  endif
